<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <script src="react.development.js"></script>
    <script src="react-dom.development.js"></script>
    <script src='babel.js'></script>
    <script src='react-router-dom.js'></script>
    <title>YODAZ</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="text/jsx">
    var HashRouter = ReactRouterDOM.HashRouter;
    var Link = ReactRouterDOM.Link;
    var Route = ReactRouterDOM.Route;

    class Cities extends React.Component {

      constructor(props){
        super()
        this.state = { cities: []}
      }

      componentDidMount(){
        fetch('http://cities.jonkri.se/')
        .then(response => response.json())
        .then(result => {
          console.log(result);
          this.setState({ cities: result}) })
      }

      render(){
        var citiesToRender = this.state.cities.map(city =>
          <tr key={city.id}>
            <td>{city.name}</td>
            <td>{city.population}</td>
          </tr>)

        return <div>
          <table style={{backgroundColor: 'gray', color: 'white'}}>
            <thead>
              <tr>
                <th>Stad</th>
                <th>Antal</th>
              </tr>
            </thead>
            <tbody>
              {citiesToRender}
            </tbody>
          </table>
        </div>
      }
    }

    class EditCities extends React.Component {

    }

    class Food extends React.Component {
      render () {
        return  <section><h1>Food</h1><p>...</p></section>
      }
    }

    // MOA
    class Addcity extends React.Component {
            constructor(props) {
              super(props);
              this.state = { valuecity: "City name", valuepop: "Population" }
              this.onClick = this.onClick.bind(this)
              this.onTextChange = this.onTextChange.bind(this)
            }

            render() {
              return <section>
              <input id="inputcity" valuecity={this.state.valuecity} onChange={this.onTextChange}/>
              <input id="inputpop" valuepop={this.state.valuepop} onChange={this.onTextChange}/>
              <button onClick={this.onClick}>ADD CITY!</button>
              </section>
            }

            onClick(event) {
            console.log("City is: " + this.state.valuecity);
            console.log("Population is: " + this.state.valuepop);

          fetch("http://cities.jonkri.se/", {
              body: JSON.stringify({ "name": this.state.valuecity, "population": this.state.valuepop }),
              headers: {
                "Content-Type": "application/json"
              },
              method: 'POST'
           });

           alert("You added a city");
          }

          onTextChange(event) {
            console.log(event.target.value);

            if (event.target.id == "inputcity") {
              console.log("clicked input city");
              this.setState({valuecity: event.target.value})
            } else {
              console.log("clicked input pop");
              this.setState({valuepop: event.target.value})
            }
          }
              componentDidMount() {
                fetch('http://cities.jonkri.se/')
                .then(function (response) { return response.json(); })
                .then(function (result) { console.log(result); });
          }
  }

    // VICTORIA
    class Updatecity extends React.Component {
      render () {
        return  <section><h1>Update City</h1><p>...</p></section>
      }
    }

    // EMMA
    class Updatepopulation extends React.Component {
      render () {
        return  <section><h1>Update Population</h1><p>...</p></section>
      }
    }

    // HANNA
    class Deletecity extends React.Component {
      render () {
        return  <section>
        <h1>Delete City</h1>
        <button onClick={this.onClick}> <img alt="Trash bin symbol" src="trash-bin-symbol.jpg"/> </button>
        </section>
      }

      onClick(event) {
      fetch('http://cities.jonkri.se/5347da70-fef3-4e8f-ba49-e8010edba878', {
        method: "DELETE"
      });}

    }



      ReactDOM.render(<HashRouter>
        <div>
            <nav>
              <ul>
                <li><Link to="/getallcities">Get all Cities</Link></li>
                <li><Link to="/addcity">Add City</Link></li>
                <li><Link to="/updatecity">Update City</Link></li>
                <li><Link to="/updatepopulation">Update Population</Link></li>
                <li><Link to="/deletecity">Delete City</Link></li>
                <li><Link to="/food">Food</Link></li>
            </ul>
          </nav>
        <Route component={Cities} path='/getallcities' />
        <Route component={Addcity} path='/addcity' />
        <Route component={Updatecity} path='/updatecity' />
        <Route component={Updatepopulation} path='/updatepopulation' />
        <Route component={Deletecity} path='/deletecity' />
        <Route component={Food} path='/food' />
        </div>
      </HashRouter>,
        document.getElementById('app')
      );

    </script>

  </body>
</html>
